//*****************************************************************************
//
// ゲーム画面処理 [game.cpp]
// Author : 小熊 朗
//
//*****************************************************************************

//*****************************************************************************
//インクルードファイル
//*****************************************************************************
#include "mode.h"
#include "mode_base.h"
#include "scene.h"
#include "player.h"

//*****************************************************************************
//静的メンバ変数
//*****************************************************************************

//*****************************************************************************
//コンストラクタ
//*****************************************************************************
CMode::CMode()
{
	//ポインタ変数
	m_pModeBase = nullptr;	//モードの基底
}

//*****************************************************************************
//デストラクタ
//*****************************************************************************
CMode::~CMode()
{
}

//*****************************************************************************
//生成
//*****************************************************************************
CMode * CMode::Create()
{
	CMode *pMode = nullptr;

	//インスタンス生成
	if (pMode == nullptr)
	{
		pMode = new CMode;
		if (pMode != nullptr)
		{
			pMode->Init();
			return pMode;
		}
	}
	return nullptr;
}

//*****************************************************************************
//初期化
//*****************************************************************************
HRESULT CMode::Init(void)
{
	POINT posPoint;										//マウス情報を取得
	GetCursorPos(&posPoint);							// マウス座標を取得する
	//ターゲットマーカーの生成
	m_pPlayer = CPlayer::Create(D3DXVECTOR3((float)posPoint.x, (float)posPoint.y, 0.0f),
		D3DXVECTOR3(PLAYER_SIZEX, PLAYER_SIZEY, 0));

	return S_OK;
}

//*****************************************************************************
//更新
//*****************************************************************************
void CMode::Update(void)
{
	if (m_pModeBase != nullptr)
	{
		m_pModeBase->Update(this);
	}
}

//*****************************************************************************
//終了
//*****************************************************************************
void CMode::Uninit(void)
{
	if (m_pModeBase != nullptr)
	{
		m_pModeBase->Uninit(this);
	}
	CScene::ReleaseAll();
	m_pModeBase == nullptr;
}

//*****************************************************************************
//状態遷移
//*****************************************************************************
void CMode::ChangeState(CModeBase * pModeBase)
{
	m_pModeBase = pModeBase;
	if (m_pModeBase != nullptr)
	{
		m_pModeBase->Init(this);
	}
}
